<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serpientes y Escaleras: Salud Sexual</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Fuente personalizada */
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }
        
        /* Estilos para el tablero del juego */
        .board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            border: 2px solid #4a5568; /* gray-700 */
            aspect-ratio: 1 / 1; /* Mantiene el tablero cuadrado */
        }

        .board-square {
            border: 1px solid #cbd5e0; /* gray-300 */
            position: relative;
            display: flex;
            justify-content: flex-end;
            align-items: flex-start;
            padding: 4px;
            font-size: 0.75rem; /* text-xs */
            font-weight: bold;
            color: #718096; /* gray-500 */
            background-color: white;
            transition: background-color 0.3s;
        }

        /* Estilos para las casillas de serpientes y escaleras */
        .snake-start {
            background-color: #fed7d7; /* red-200 */
        }
        .snake-start::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem; /* Aumenta el tama帽o del emoji */
            opacity: 0.8;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col p-4">

    <!-- T铆tulos -->
    <header class="w-full max-w-3xl mx-auto text-center mb-6">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-4"> Serpientes y Escaleras: Salud Sexual </h1>
        <p class="text-center text-gray-600">Un juego basado en los factores del PDF "Salud Sexual Hol铆stica".</p>
    </header>

    <!-- Contenido principal (juego) que crece -->
    <main class="w-full max-w-3xl mx-auto flex-grow">
        <!-- Contenedor del juego (Tablero + Controles) en una tarjeta blanca -->
        <div class="bg-white rounded-lg shadow-xl p-6">
            
            <!-- Columna del Tablero -->
            <div class="w-full max-w-2xl mx-auto mb-6"> <!-- Centrado y con ancho m谩ximo -->
                <div class="board-container relative rounded-lg overflow-hidden shadow-lg">
                    <!-- El tablero se genera con JS -->
                    <div class="board" id="board"></div>
                    
                    <!-- Fichas de Jugador -->
                    <div id="player1-token" class="player-token"></div>
                    <div id="player2-token" class="player-token"></div>
                </div>
            </div>

            <!-- Controles e Informaci贸n (Ahora debajo del tablero) -->
            <div class="flex flex-col md:flex-row gap-6">
                
                <!-- Info de Jugadores -->
                <div class="w-full md:w-1/2">
                    <div class="bg-gray-50 rounded-lg p-4 shadow-inner h-full">
                        <h2 class="text-xl font-semibold mb-3 text-gray-700">Jugadores</h2>
                        <div class="space-y-3">
                            <div class="flex items-center gap-3 p-3 rounded-lg" id="player1-info-box">
                                <span class="w-8 h-8 rounded-full bg-red-600 border-2 border-white shadow"></span>
                                <div>
                                    <div class="font-bold text-gray-800">Jugador 1</div>
                                    <div class="text-sm text-gray-600">Posici贸n: <span id="player1-pos" class="font-semibold">0</span></div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 p-3 rounded-lg" id="player2-info-box">
                                <span class="w-8 h-8 rounded-full bg-blue-600 border-2 border-white shadow"></span>
                                <div>
                                    <div class="font-bold text-gray-800">Jugador 2</div>
                                    <div class="text-sm text-gray-600">Posici贸n: <span id="player2-pos" class="font-semibold">0</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Controles del Juego -->
                <div class="w-full md:w-1/2">
                    <div class="bg-gray-50 rounded-lg p-4 shadow-inner text-center h-full">
                        <div classs="mb-4">
                            <div class="text-lg font-semibold text-gray-800" id="current-turn">Turno: Jugador 1</div>
                        </div>
                        
                        <div class="my-6 flex justify-center">
                            <div id="dice" class="w-20 h-20 bg-white rounded-lg shadow-md flex items-center justify-center text-5xl font-bold text-gray-700">
                                ?
                            </div>
                        </div>
                        
                        <button id="roll-btn" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg shadow-lg hover:bg-indigo-700 active:bg-indigo-800 transform active:scale-95 transition-all duration-150">
                            Tirar Dado
                        </button>
                        
                        <button id="restart-btn" class="w-full bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-400 transition-all duration-150 mt-4">
                            Reiniciar Juego
                        </button>
                    </div>
                </div>
                
            </div>
        </div>
    </main>

    <!-- Pie de P谩gina con Informaci贸n -->
    <footer class="w-full max-w-3xl mx-auto text-center p-6 mt-4 flex-shrink-0">
        <div class="text-xs text-gray-500 space-y-1">
            <p class="font-semibold">Equipo 4: Feria de sexualidad responsable</p>
            <p>Alumnos: Leal Saavedra Hector Emmanuel, Jair Enrique Espada Fernandez</p>
            <p>Universidad Aut贸noma del Estado de Hidalgo | Enero - Junio 2025</p>
            <p>Catedr谩tica: Dra. TANIA BERENICE RAMIREZ GONZALEZ</p>
        </div>
    </footer>

    <!-- Modal de Ganador -->
    <div id="winner-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 transition-opacity duration-300 hidden opacity-0">
        <div class="bg-white rounded-lg p-8 shadow-2xl text-center max-w-sm mx-auto transform scale-95 transition-all duration-300">
            <h2 class="text-4xl mb-4"></h2>
            <h2 class="text-2xl font-bold text-gray-800 mb-4">隆Felicidades!</h2>
            <p id="winner-text" class="text-gray-600 text-lg mb-6"></p>
            <button id="play-again-btn" class="bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-700 transition-all duration-150">
                Jugar de Nuevo
            </button>
        </div>
    </div>
    
    <!-- Modal de Informaci贸n (Serpientes/Escaleras) -->
    <div id="info-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 transition-opacity duration-300 hidden opacity-0">
        <div class="bg-white rounded-lg p-8 shadow-2xl max-w-md mx-auto transform scale-95 transition-all duration-300">
            <h2 id="info-title" class="text-2xl font-bold text-center mb-4"></h2>
            <p id="info-text" class="text-gray-600 text-center text-base mb-6"></p>
            <p id="info-move" class="text-gray-800 text-center font-semibold text-lg mb-6"></p>
            <button id="info-close-btn" class="w-full bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-400 transition-all duration-150">
                Cerrar
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- CONSTANTES Y ESTADO DEL JUEGO ---
            const BOARD_SIZE = 100;
            const ROWS = 10;
            const COLS = 10;
            
            // --- DEFINICIN DE SERPIENTES Y ESCALERAS (BASADO EN EL PDF) ---
            // Mapeo: casilla_inicio: casilla_fin
            const snakesAndLadders = {
                // ESCALERAS (Factores Positivos)
                3: 15,  // Educaci贸n Sexual Integral
                8: 21,  // Buena Comunicaci贸n
                12: 26, // Enfoque positivo y respetuoso (NUEVO)
                20: 35, // Autoestima Alta
                28: 40, // Autocuidado
                33: 44, // Experiencias placenteras y seguras (NUEVO)
                40: 52, // Di谩logo Abierto
                51: 63, // Acceso a Informaci贸n
                65: 76, // Imagen corporal positiva (NUEVO)
                71: 85, // Respeto y Derechos
                80: 92, // Equidad
                82: 94, // Movimientos sociales (NUEVO)
                
                // SERPIENTES (Factores Negativos)
                17: 9,  // Desinformaci贸n
                23: 16, // Estigma social (NUEVO)
                39: 29, // Control sobre sexualidad femenina (NUEVO)
                45: 34, // Baja Autoestima
                49: 38, // Tab煤es y Verg眉enza
                56: 48, // Presi贸n Social
                62: 50, // Mala Comunicaci贸n
                64: 55, // Coerci贸n
                70: 61, // Falta de acceso a anticonceptivos (NUEVO)
                87: 77, // Discriminaci贸n
                93: 83, // Estr茅s y Ansiedad
                95: 86, // Mitos Culturales
                97: 88, // Abuso en sistemas de salud (NUEVO)
                99: 89, // Barreras Socioecon贸micas
            };

            // Textos explicativos para cada casilla especial
            const squareInfo = {
                // ESCALERAS
                3: { title: "隆Escalera!", text: "La Educaci贸n Sexual Integral (ESI) es un derecho. Te da informaci贸n cient铆fica y laica para tomar decisiones libres, informadas y responsables sobre tu cuerpo y tu sexualidad." },
                8: { title: "隆Escalera!", text: "La Buena Comunicaci贸n en la pareja es clave. Permite expresar deseos, l铆mites y necesidades, fortaleciendo la confianza y la conexi贸n emocional, que son pilares del bienestar sexual." },
                12: { title: "隆Escalera!", text: "Un Enfoque Positivo y Respetuoso, como el que promueve la OMS, ve la sexualidad como una fuente de bienestar f铆sico, mental y social, m谩s all谩 de la ausencia de enfermedad." },
                20: { title: "隆Escalera!", text: "Tener Autoestima Alta impacta directamente en tu vida sexual. Te permite sentirte con m谩s confianza, tener m谩s iniciativa y disfrutar plenamente de la intimidad sin inseguridades." },
                28: { title: "隆Escalera!", text: "El Autocuidado (ejercicio, meditaci贸n, dieta equilibrada) reduce el estr茅s y mejora tu bienestar general, lo cual se refleja directamente en una vida sexual m谩s saludable y plena." },
                33: { title: "隆Escalera!", text: "Buscar Experiencias Placenteras y Seguras es un derecho sexual fundamental. Implica vivir la sexualidad libre de coerci贸n, discriminaci贸n y violencia." },
                40: { title: "隆Escalera!", text: "Un Di谩logo Abierto sobre sexualidad, libre de prejuicios, te permite buscar ayuda profesional o consejo cuando lo necesitas, rompiendo barreras de silencio." },
                51: { title: "隆Escalera!", text: "El Acceso a Informaci贸n de calidad y verificada es crucial. Te permite desmentir mitos y tomar decisiones informadas sobre anticonceptivos, placer y salud." },
                65: { title: "隆Escalera!", text: "Fomentar una Imagen Corporal Positiva te ayuda a aceptar y valorar tu cuerpo. Esto reduce la inseguridad y te permite disfrutar de la intimidad sin rechazo al propio cuerpo." },
                71: { title: "隆Escalera!", text: "Conocer tus Derechos Sexuales y Reproductivos te empodera. Te ayuda a exigir respeto, poner l铆mites y construir relaciones seguras e igualitarias." },
                80: { title: "隆Escalera!", text: "La Equidad socioecon贸mica es un factor protector. Un mejor nivel educativo y econ贸mico permite un acceso real y efectivo a servicios de salud sexual y reproductiva de calidad." },
                82: { title: "隆Escalera!", text: "Movimientos Sociales como la 'Marea Verde' impulsan la discusi贸n p煤blica sobre derechos y libertades sexuales, ayudando a generar cambios legales y culturales a favor de la autonom铆a." },
                
                // SERPIENTES
                17: { title: "隆Serpiente!", text: "La Desinformaci贸n y la falta de educaci贸n sexual integral clara pueden llevar a pr谩cticas de riesgo, embarazos no deseados e infecciones de transmisi贸n sexual." },
                23: { title: "隆Serpiente!", text: "El Estigma Social rodea temas como el placer o el acceso a anticonceptivos. Genera verg眉enza y dificulta que las personas, especialmente j贸venes, busquen ayuda o informaci贸n." },
                39: { title: "隆Serpiente!", text: "El Control sobre la Sexualidad Femenina, basado en ideas como el 'culto a la virginidad', reprime el deseo de las mujeres y limita su autonom铆a corporal." },
                45: { title: "隆Serpiente!", text: "La Baja Autoestima es una barrera emocional. Genera inseguridad, falta de iniciativa, incomodidad con el propio cuerpo y una menor capacidad de disfrutar la vida sexual." },
                49: { title: "隆Serpiente!", text: "Los Tab煤es y la Verg眉enza que la cultura impone sobre la sexualidad impiden hablar abiertamente, resolver dudas y buscar ayuda profesional, perpetuando la desinformaci贸n." },
                56: { title: "隆Serpiente!", text: "La Presi贸n Social por 'c谩nones de belleza' inalcanzables (vistos en redes sociales) puede crear una imagen corporal negativa que sabotea la confianza en la intimidad." },
                62: { title: "隆Serpiente!", text: "La Mala Comunicaci贸n o los conflictos no resueltos en la pareja son un factor emocional clave que impacta negativamente la intimidad, el deseo y el bienestar sexual." },
                64: { title: "隆Serpiente!", text: "La Coerci贸n (presionar o forzar a alguien a tener relaciones) es una forma de violencia. La sexualidad debe ser siempre libre, consensuada y segura." },
                70: { title: "隆Serpiente!", text: "La Falta de Acceso a M茅todos Anticonceptivos y a servicios de salud de calidad es una barrera socioecon贸mica que afecta desproporcionadamente a j贸venes y grupos vulnerables." },
                87: { title: "隆Serpiente!", text: "La Discriminaci贸n por etnia, discapacidad u orientaci贸n sexual en los servicios de salud impide que las personas reciban la atenci贸n adecuada y respetuosa que necesitan." },
                93: { title: "隆Serpiente!", text: "El Estr茅s y la Ansiedad cr贸nicos son factores psicol贸gicos que pueden interferir directamente con el deseo sexual y, en muchos casos, provocar disfunciones." },
                95: { title: "隆Serpiente!", text: "Los Mitos Culturales (como el 'imperativo biol贸gico masculino') generan culpa en las mujeres por su deseo y, peligrosamente, pueden usarse para justificar el abuso o la coerci贸n." },
                97: { title: "隆Serpiente!", text: "El Abuso o Maltrato en Sistemas de Salud (como el 'abuso racista' mencionado en el PDF) genera desconfianza y aleja a las poblaciones marginadas de la atenci贸n m茅dica." },
                99: { title: "隆Serpiente!", text: "Las Barreras Socioecon贸micas (pobreza, baja escolaridad) aumentan la vulnerabilidad, limitan el acceso a informaci贸n y servicios, y perpet煤an ciclos de riesgo." },
            };
            
            let playerPositions = { 1: 0, 2: 0 };
            let currentPlayer = 1;
            let gameInProgress = true;
            let squareDimensions = { width: 0, height: 0 };

            // --- REFERENCIAS AL DOM ---
            const board = document.getElementById('board');
            const rollBtn = document.getElementById('roll-btn');
            const diceFace = document.getElementById('dice');
            const player1Pos = document.getElementById('player1-pos');
            const player2Pos = document.getElementById('player2-pos');
            const player1InfoBox = document.getElementById('player1-info-box');
            const player2InfoBox = document.getElementById('player2-info-box');
            const currentTurnInfo = document.getElementById('current-turn');
            const restartBtn = document.getElementById('restart-btn');
            
            // Modales
            const winnerModal = document.getElementById('winner-modal');
            const winnerText = document.getElementById('winner-text');
            const playAgainBtn = document.getElementById('play-again-btn');
            
            const infoModal = document.getElementById('info-modal');
            const infoTitle = document.getElementById('info-title');
            const infoText = document.getElementById('info-text');
            const infoMove = document.getElementById('info-move');
            const infoCloseBtn = document.getElementById('info-close-btn');

            // Fichas
            const player1Token = document.getElementById('player1-token');
            const player2Token = document.getElementById('player2-token');

            // --- FUNCIONES DEL JUEGO ---

            /**
             * Inicializa el tablero y el estado del juego.
             */
            function initializeGame() {
                playerPositions = { 1: 0, 2: 0 };
                currentPlayer = 1;
                gameInProgress = true;
                
                createBoard();
                updatePlayerPositionsVisual();
                updateTurnIndicator();
                
                diceFace.textContent = '?';
                hideModal(winnerModal);
                hideModal(infoModal);
                
                // Asegurarse de que las dimensiones de las casillas se calculen despu茅s de crear el tablero
                if (board.firstChild) {
                    squareDimensions.width = board.firstChild.offsetWidth;
                    squareDimensions.height = board.firstChild.offsetHeight;
                }
            }

            /**
             * Crea las 100 casillas del tablero en el DOM.
             */
            function createBoard() {
                board.innerHTML = ''; // Limpia el tablero
                let numbers = [];
                for (let i = 1; i <= BOARD_SIZE; i++) {
                    numbers.push(i);
                }

                // Organiza los n煤meros en el orden de serpientes y escaleras
                let boardNumbers = [];
                for (let row = 0; row < ROWS; row++) {
                    let rowNumbers = numbers.slice(row * COLS, (row + 1) * COLS);
                    if (row % 2 !== 0) {
                        rowNumbers.reverse(); // Invierte filas impares
                    }
                    boardNumbers = boardNumbers.concat(rowNumbers);
                }
                boardNumbers.reverse(); // Invierte todo el tablero para que el 1 quede abajo
                
                // Crea los elementos div
                for (const num of boardNumbers) {
                    const square = document.createElement('div');
                    square.classList.add('board-square');
                    square.dataset.squareNumber = num;
                    
                    const numberSpan = document.createElement('span');
                    numberSpan.classList.add('square-number');
                    numberSpan.textContent = num;
                    square.appendChild(numberSpan);

                    if (snakesAndLadders[num]) {
                        const isLadder = snakesAndLadders[num] > num;
                        square.classList.add(isLadder ? 'ladder-start' : 'snake-start');
                        square.dataset.goto = snakesAndLadders[num];
                    }
                    
                    board.appendChild(square);
                }
            }

            /**
             * Lanza el dado y mueve al jugador.
             */
            function rollDice() {
                if (!gameInProgress) return;
                
                gameInProgress = false; // Bloquea el bot贸n mientras se mueve
                
                const roll = Math.floor(Math.random() * 6) + 1;
                
                // Anima el dado
                diceFace.textContent = roll;
                diceFace.classList.add('dice-roll');
                setTimeout(() => diceFace.classList.remove('dice-roll'), 500);

                setTimeout(() => {
                    movePlayer(roll);
                }, 500); // Espera a que termine la animaci贸n del dado
            }

            /**
             * Mueve al jugador la cantidad de casillas indicadas.
             */
            function movePlayer(roll) {
                let currentPos = playerPositions[currentPlayer];
                let newPos = currentPos + roll;

                // --- Comprobar si gan贸 ---
                if (newPos >= BOARD_SIZE) {
                    playerPositions[currentPlayer] = BOARD_SIZE;
                    updatePlayerPositionsVisual();
                    endGame(currentPlayer);
                    return;
                }

                playerPositions[currentPlayer] = newPos;
                updatePlayerPositionsVisual();

                // --- Comprobar Serpientes o Escaleras ---
                setTimeout(() => {
                    checkSpecialSquare(newPos);
                }, 600); // Espera a que la ficha llegue
            }

            /**
             * Comprueba si la casilla es una serpiente o escalera y act煤a.
             */
            function checkSpecialSquare(pos) {
                const destination = snakesAndLadders[pos];
                
                if (destination) {
                    const info = squareInfo[pos];
                    const isLadder = destination > pos;
                    
                    showInfoModal(
                        info.title,
                        info.text,
                        `${isLadder ? 'Avanzas' : 'Retrocedes'} a la casilla ${destination}`
                    );
                    
                    playerPositions[currentPlayer] = destination;
                    
                    // Espera a que el usuario cierre el modal para mover la ficha y cambiar de turno
                    infoCloseBtn.onclick = () => {
                        hideModal(infoModal);
                        updatePlayerPositionsVisual();
                        switchPlayer();
                        gameInProgress = true; // Desbloquea el bot贸n
                    };

                } else {
                    // Si no es especial, solo cambia de turno
                    switchPlayer();
                    gameInProgress = true; // Desbloquea el bot贸n
                }
            }

            /**
             * Cambia al siguiente jugador.
             */
            function switchPlayer() {
                currentPlayer = currentPlayer === 1 ? 2 : 1;
                updateTurnIndicator();
            }

            /**
             * Actualiza el indicador visual de turno.
             */
            function updateTurnIndicator() {
                currentTurnInfo.textContent = `Turno: Jugador ${currentPlayer}`;
                if (currentPlayer === 1) {
                    player1InfoBox.classList.add('bg-indigo-100');
                    player2InfoBox.classList.remove('bg-indigo-100');
                } else {
                    player2InfoBox.classList.add('bg-indigo-100');
                    player1InfoBox.classList.remove('bg-indigo-100');
                }
            }

            /**
             * Actualiza la posici贸n visual de las fichas y el texto.
             */
            function updatePlayerPositionsVisual() {
                // Actualiza texto
                player1Pos.textContent = playerPositions[1];
                player2Pos.textContent = playerPositions[2];

                // Actualiza fichas
                const pos1 = getCoordsForPosition(playerPositions[1]);
                player1Token.style.left = pos1.x;
                player1Token.style.top = pos1.y;

                const pos2 = getCoordsForPosition(playerPositions[2]);
                player2Token.style.left = pos2.x;
                player2Token.style.top = pos2.y;
            }

            /**
             * Calcula las coordenadas (x, y) en p铆xeles para una casilla.
             */
            function getCoordsForPosition(pos) {
                if (pos === 0) {
                    // Posici贸n inicial fuera del tablero
                    return { x: '25%', y: `calc(100% + 20px)` }; 
                }

                const square = board.querySelector(`[data-square-number="${pos}"]`);
                if (!square) return { x: '50%', y: '50%' }; // Fallback

                const squareRect = square.getBoundingClientRect();
                const boardRect = board.getBoundingClientRect();

                // Calcula el centro de la casilla relativo al tablero
                const x = (squareRect.left - boardRect.left) + (squareRect.width / 2);
                const y = (squareRect.top - boardRect.top) + (squareRect.height / 2);

                return { x: `${x}px`, y: `${y}px` };
            }

            /**
             * Muestra el modal de informaci贸n.
             */
            function showInfoModal(title, text, moveText) {
                infoTitle.textContent = title;
                infoText.textContent = text;
                infoMove.textContent = moveText;
                
                infoModal.classList.remove('hidden');
                setTimeout(() => infoModal.classList.remove('opacity-0'), 10);
                setTimeout(() => infoModal.querySelector('.transform').classList.remove('scale-95'), 10);
            }

            /**
             * Oculta un modal (gen茅rico).
             */
            function hideModal(modal) {
                modal.classList.add('opacity-0');
                modal.querySelector('.transform').classList.add('scale-95');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }

            /**
             * Termina el juego y muestra al ganador.
             */
            function endGame(winner) {
                gameInProgress = false;
                winnerText.textContent = `隆El Jugador ${winner} ha ganado!`;
                
                winnerModal.classList.remove('hidden');
                setTimeout(() => winnerModal.classList.remove('opacity-0'), 10);
                setTimeout(() => winnerModal.querySelector('.transform').classList.remove('scale-95'), 10);
            }


            // --- EVENT LISTENERS ---
            rollBtn.addEventListener('click', rollDice);
            restartBtn.addEventListener('click', initializeGame);
            playAgainBtn.addEventListener('click', initializeGame);
            // El listener de infoCloseBtn se asigna din谩micamente en checkSpecialSquare

            // --- INICIAR JUEGO ---
            initializeGame();
            
            // Recalcular dimensiones si la ventana cambia de tama帽o
            window.addEventListener('resize', () => {
                if (board.firstChild) {
                    squareDimensions.width = board.firstChild.offsetWidth;
                    squareDimensions.height = board.firstChild.offsetHeight;
                    updatePlayerPositionsVisual(); // Reajusta las fichas
                }
            });
        });
    </script>
</body>
</html>
